import{I as c}from"./app-CQqk7krA.js";import{p as o}from"./personaService-BcRaQCsB.js";const d=c("persone",{state:()=>{const r=localStorage.getItem("persone_list_state"),t={persone:[],persona:null,loading:!1,error:null,search:"",sortBy:"id",sortDir:"asc",pagination:{current_page:1,last_page:1,per_page:15,total:0}};if(r)try{const e=JSON.parse(r);return{...t,search:e.search||"",sortBy:e.sortBy||"id",sortDir:e.sortDir||"asc",pagination:{...t.pagination,current_page:e.current_page||1}}}catch(e){console.error("Errore nel caricamento dello stato salvato:",e)}return t},actions:{async fetchPersone(r="",t=1,e=null,s=null){var i,l;this.loading=!0,this.error=null,this.search=r;const n=e!==null?e:this.sortBy,p=s!==null?s:this.sortDir;e!==null&&(this.sortBy=e),s!==null&&(this.sortDir=s);try{const a=await o.getAll(r,t,n,p);a.data&&a.data.data&&a.data.meta?(this.persone=a.data.data,this.pagination={current_page:a.data.meta.current_page||1,last_page:a.data.meta.last_page||1,per_page:a.data.meta.per_page||15,total:a.data.meta.total||0}):a.data&&a.data.data&&a.data.current_page?(this.persone=a.data.data,this.pagination={current_page:a.data.current_page||1,last_page:a.data.last_page||1,per_page:a.data.per_page||15,total:a.data.total||0}):Array.isArray(a.data)?(this.persone=a.data,this.pagination={current_page:1,last_page:1,per_page:a.data.length,total:a.data.length}):(this.persone=[],this.pagination={current_page:1,last_page:1,per_page:15,total:0}),this.saveState()}catch(a){this.error=((l=(i=a.response)==null?void 0:i.data)==null?void 0:l.message)||"Errore nel caricamento delle persone",this.persone=[],this.pagination={current_page:1,last_page:1,per_page:15,total:0}}finally{this.loading=!1}},saveState(){const r={search:this.search,sortBy:this.sortBy,sortDir:this.sortDir,current_page:this.pagination.current_page};localStorage.setItem("persone_list_state",JSON.stringify(r))},clearState(){localStorage.removeItem("persone_list_state"),this.search="",this.sortBy="id",this.sortDir="asc",this.pagination.current_page=1},setSorting(r,t){this.sortBy=r,this.sortDir=t},async fetchPersona(r){var t,e;this.loading=!0,this.error=null;try{const s=await o.getById(r);this.persona=s.data.data||s.data}catch(s){this.error=((e=(t=s.response)==null?void 0:t.data)==null?void 0:e.message)||"Errore nel caricamento della persona"}finally{this.loading=!1}},async createPersona(r){var t,e;this.loading=!0,this.error=null;try{return{success:!0,data:(await o.create(r)).data}}catch(s){return this.error=((e=(t=s.response)==null?void 0:t.data)==null?void 0:e.message)||"Errore nella creazione della persona",{success:!1,error:this.error}}finally{this.loading=!1}},async updatePersona(r,t){var e,s;this.loading=!0,this.error=null;try{return{success:!0,data:(await o.update(r,t)).data}}catch(n){return this.error=((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||"Errore nell'aggiornamento della persona",{success:!1,error:this.error}}finally{this.loading=!1}},async deletePersona(r){var t,e;this.loading=!0,this.error=null;try{return await o.delete(r),{success:!0}}catch(s){return this.error=((e=(t=s.response)==null?void 0:t.data)==null?void 0:e.message)||"Errore nell'eliminazione della persona",{success:!1,error:this.error}}finally{this.loading=!1}}}});export{d as u};
