import{f as W,c as p,o as u,g as U,a as e,h as T,r as k,i as V,d as q,j as P,k as G,u as I,e as K,n as Q,l as F,m as E,b as w,p as v,q as f,s as b,t,w as J,x as X,y,F as Y,z as R,A as Z,B as _,C as D}from"./app-CQqk7krA.js";const ee=["title"],te={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oe={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},re={__name:"ThemeToggle",setup(z){const l=W(),n=()=>{l.toggleTheme()};return(o,a)=>(u(),p("button",{onClick:n,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:U(l).theme==="dark"?"Passa al tema chiaro":"Passa al tema scuro"},[U(l).theme==="dark"?(u(),p("svg",te,[...a[0]||(a[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(u(),p("svg",oe,[...a[1]||(a[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))],8,ee))}},se={class:"relative"},ae={__name:"LanguageSwitcher",setup(z){const l=T(),n=k(l.locale),o=()=>{l.setLocale(n.value)};return V(()=>{n.value=l.locale}),(a,x)=>(u(),p("div",se,[q(e("select",{"onUpdate:modelValue":x[0]||(x[0]=M=>n.value=M),onChange:o,class:"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[1]||(x[1]=[G('<option value="it">IT</option><option value="en">EN</option><option value="fr">FR</option><option value="de">DE</option><option value="es">ES</option><option value="pt">PT</option>',6)])],544),[[P,n.value]])]))}},le={class:"bg-gray-300 dark:bg-gray-800 shadow-md flex-shrink-0",style:{"z-index":"1000",position:"relative"}},ne={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ie={class:"flex justify-between h-16"},de={class:"flex items-center space-x-6"},ue={class:"flex gap-2"},ce={class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm flex items-center gap-1"},pe={class:"py-1"},ge={class:"flex items-center space-x-4"},me={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},he={class:"flex justify-between items-center mb-4"},ve={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},xe={class:"space-y-4"},be={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},ke={class:"flex items-start gap-3"},fe={class:"flex-1"},ye={class:"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-2"},_e={class:"text-xs text-blue-800 dark:text-blue-300 mb-2"},we={class:"text-xs text-blue-800 dark:text-blue-300 mb-2"},Ce={class:"text-xs text-blue-800 dark:text-blue-300 mb-2"},Me={class:"mt-3 pt-2 border-t border-blue-200 dark:border-blue-700"},je={href:"/esempio_gedcom.ged",download:"",class:"inline-flex items-center gap-1.5 text-xs font-medium text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-200 transition-colors"},Be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ze={key:0,class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},$e={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ae={class:"flex gap-2"},Le=["disabled"],Se={key:0},Re={key:1,class:"flex items-center justify-center gap-2"},Te={key:0,class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},Ve={key:0},Ee={__name:"Navbar",setup(z){const l=I(),n=T();K();const o=s=>n.t(s),a=k(null),x=k(null),M=()=>{if(a.value&&x.value){const s=a.value.getBoundingClientRect();x.value.style.top=`${s.bottom+8}px`,x.value.style.left=`${s.left}px`}};V(()=>{if(Object.keys(n.translations).length===0&&n.loadTranslations(),a.value){const s=a.value.closest(".group");s&&s.addEventListener("mouseenter",()=>{Q(()=>{M()})})}}),F(()=>n.locale,()=>{n.loadTranslations()});const $=async()=>{await l.logout()},A=async()=>{try{const s=l.token,r=await R.get("/api/export/gedcom",{headers:{Authorization:`Bearer ${s}`,Accept:"application/octet-stream"},responseType:"blob"}),c=window.URL.createObjectURL(new Blob([r.data])),d=document.createElement("a");d.href=c,d.setAttribute("download","albero_genealogico.ged"),document.body.appendChild(d),d.click(),d.remove(),window.URL.revokeObjectURL(c)}catch(s){console.error("Errore durante l'export GEDCOM:",s),alert("Errore durante l'export. Assicurati di essere autenticato.")}},L=async()=>{try{const s=l.token,r=await R.get("/api/export/csv",{headers:{Authorization:`Bearer ${s}`,Accept:"text/csv"},responseType:"blob"}),c=window.URL.createObjectURL(new Blob([r.data])),d=document.createElement("a");d.href=c,d.setAttribute("download","albero_genealogico.csv"),document.body.appendChild(d),d.click(),d.remove(),window.URL.revokeObjectURL(c)}catch(s){console.error("Errore durante l'export CSV:",s),alert("Errore durante l'export. Assicurati di essere autenticato.")}},C=k(!1),j=k(null),g=k(null),i=k(!1),m=k(0),h=k(null),H=s=>{g.value=s.target.files[0],h.value=null},N=async()=>{var s,r;if(g.value){i.value=!0,m.value=0,h.value=null;try{const c=new FormData;c.append("file",g.value);const d=setInterval(()=>{m.value<90&&(m.value+=10)},200),B=await R.post("/api/import/gedcom",c,{headers:{"Content-Type":"multipart/form-data"}});clearInterval(d),m.value=100,h.value={success:B.data.success,message:B.data.message||o("import.import_complete"),data:B.data.data},B.data.success&&setTimeout(()=>{window.location.reload()},2e3)}catch(c){m.value=0,h.value={success:!1,message:((r=(s=c.response)==null?void 0:s.data)==null?void 0:r.message)||o("import.import_error")}}finally{i.value=!1}}},S=()=>{i.value||(C.value=!1,g.value=null,h.value=null,m.value=0,j.value&&(j.value.value=""))},O=s=>{if(!s)return"0 B";const r=1024,c=["B","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(r));return Math.round(s/Math.pow(r,d)*100)/100+" "+c[d]};return(s,r)=>{var d;const c=E("router-link");return u(),p(Y,null,[e("nav",le,[e("div",ne,[e("div",ie,[e("div",de,[v(c,{to:"/persone",class:"text-xl font-bold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors"},{default:f(()=>[b(t(o("app.name")),1)]),_:1}),v(c,{to:"/persone/tree",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:f(()=>[b(t(o("nav.view_tree")),1)]),_:1}),v(c,{to:"/persone/family-chart",class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"},{default:f(()=>[b(t(o("nav.family_chart")),1)]),_:1}),e("div",ue,[e("div",{class:"relative group",ref_key:"exportButtonRef",ref:a,style:{"z-index":"9999"}},[e("button",ce,[b(t(o("nav.export"))+" ",1),r[1]||(r[1]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),e("div",{ref_key:"exportMenuRef",ref:x,class:"fixed w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all",style:{"z-index":"99999"}},[e("div",pe,[e("button",{onClick:A,class:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},t(o("export.gedcom_all")),1),e("button",{onClick:L,class:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},t(o("export.csv")),1)])],512)],512),e("button",{onClick:r[0]||(r[0]=B=>C.value=!0),class:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm flex items-center gap-1"},[b(t(o("nav.import"))+" ",1),r[2]||(r[2]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1))])])]),e("div",ge,[v(ae),v(re),e("button",{onClick:$,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"},t(o("nav.logout")),1)])])])]),C.value?(u(),p("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:J(S,["self"])},[e("div",me,[e("div",he,[e("h3",ve,[r[3]||(r[3]=e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),b(" "+t(o("import.gedcom_import")),1)]),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...r[4]||(r[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",xe,[e("div",be,[e("div",ke,[r[6]||(r[6]=e("svg",{class:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",fe,[e("h4",ye,t(o("import.what_is_gedcom")),1),e("p",_e,t(o("import.gedcom_description")),1),e("p",we,[e("strong",null,t(o("import.file_format"))+":",1),b(" "+t(o("import.file_format_description")),1)]),e("p",Ce,[e("strong",null,t(o("import.what_imports"))+":",1),b(" "+t(o("import.what_imports_description")),1)]),e("div",Me,[e("a",je,[r[5]||(r[5]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),b(" "+t(o("import.download_example")),1)])])])])]),e("div",null,[e("label",Be,t(o("import.select_file")),1),e("input",{ref_key:"fileInput",ref:j,type:"file",onChange:H,accept:".ged,.txt",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,544),g.value?(u(),p("p",ze,t(g.value.name)+" ("+t(O(g.value.size))+") ",1)):(u(),p("p",$e,t(o("import.file_hint")),1))]),e("div",Ae,[e("button",{onClick:N,disabled:!g.value||i.value,class:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[i.value?(u(),p("span",Re,[r[7]||(r[7]=e("svg",{class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),b(" "+t(o("import.importing")),1)])):(u(),p("span",Se,t(o("import.import")),1))],8,Le),e("button",{onClick:S,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"},t(o("common.cancel")),1)]),i.value?(u(),p("div",Te,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:X({width:m.value+"%"})},null,4)])):w("",!0),h.value?(u(),p("div",{key:1,class:y(["p-4 rounded-lg",h.value.success?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"])},[e("p",{class:y(["text-sm font-semibold",h.value.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"])},t(h.value.message),3),h.value.data?(u(),p("p",{key:0,class:y(["text-xs mt-2",h.value.success?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"])},[b(t(o("import.imported"))+": "+t(h.value.data.importate||0)+" ",1),((d=h.value.data.errori)==null?void 0:d.length)>0?(u(),p("span",Ve," | "+t(o("import.errors"))+": "+t(h.value.data.errori.length),1)):w("",!0)],2)):w("",!0)],2)):w("",!0)])])])):w("",!0)],64)}}},Ue={class:"w-16 md:w-64 bg-gray-300 dark:bg-gray-800 h-full p-2 md:p-4 transition-all duration-300 flex-shrink-0 overflow-y-auto"},De={class:"space-y-2 bg-gray-300 dark:bg-gray-800"},Ie={class:"hidden md:inline"},Fe={class:"hidden md:inline"},He={class:"hidden md:inline"},Ne={class:"hidden md:inline"},Oe={class:"hidden md:inline"},We={class:"hidden md:inline"},qe={__name:"Sidebar",setup(z){const l=Z(),n=T(),o=I(),a=g=>n.t(g);V(()=>{Object.keys(n.translations).length===0&&n.loadTranslations()}),F(()=>n.locale,()=>{n.loadTranslations()});const x=_(()=>l.path.startsWith("/persone")),M=_(()=>l.path.startsWith("/tipi-legame")),$=_(()=>l.path.startsWith("/report")),A=_(()=>l.path.startsWith("/data-quality")),L=_(()=>l.path.startsWith("/users")),C=_(()=>{var g;return((g=o.user)==null?void 0:g.role)==="admin"}),j=_(()=>l.path.startsWith("/audit-logs"));return(g,i)=>{const m=E("router-link");return u(),p("aside",Ue,[e("nav",De,[v(m,{to:"/persone",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":x.value}]),title:a("menu.persone")},{default:f(()=>[i[0]||(i[0]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),e("span",Ie,t(a("menu.persone")),1)]),_:1},8,["class","title"]),v(m,{to:"/tipi-legame",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":M.value}]),title:a("menu.tipi_legame")},{default:f(()=>[i[1]||(i[1]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)),e("span",Fe,t(a("menu.tipi_legame")),1)]),_:1},8,["class","title"]),v(m,{to:"/report",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":$.value}]),title:a("menu.report")},{default:f(()=>[i[2]||(i[2]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1)),e("span",He,t(a("menu.report")),1)]),_:1},8,["class","title"]),v(m,{to:"/data-quality",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":A.value}]),title:a("menu.data_quality")},{default:f(()=>[i[3]||(i[3]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Ne,t(a("menu.data_quality")),1)]),_:1},8,["class","title"]),C.value?(u(),D(m,{key:0,to:"/users",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":L.value}]),title:a("menu.users")},{default:f(()=>[i[4]||(i[4]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),e("span",Oe,t(a("menu.users")),1)]),_:1},8,["class","title"])):w("",!0),C.value?(u(),D(m,{key:1,to:"/audit-logs",class:y(["flex items-center justify-center md:justify-start gap-0 md:gap-3 px-2 md:px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",{"bg-blue-500 text-white":j.value}]),title:a("menu.audit_logs")},{default:f(()=>[i[5]||(i[5]=e("svg",{class:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("span",We,t(a("menu.audit_logs")),1)]),_:1},8,["class","title"])):w("",!0)])])}}},Pe={class:"bg-gray-200 dark:bg-gray-900 h-screen flex flex-col overflow-hidden"},Ge={class:"flex flex-1 overflow-hidden"},Ke={class:"flex-1 overflow-y-auto p-6"},Je={__name:"AppLayout",setup(z){return(l,n)=>{const o=E("router-view");return u(),p("div",Pe,[v(Ee),e("div",Ge,[v(qe),e("main",Ke,[v(o)])])])}}};export{Je as default};
