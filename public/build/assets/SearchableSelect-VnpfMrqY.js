import{E as T,r as w,B as x,l as C,c as u,o as d,a as y,d as L,b as k,v as q,G as I,F as O,D as A,y as B,w as K,H as f,j as U,t as m,s as V}from"./app-C8pxP4al.js";const ee={async getAll(){try{return await T.get("/tipi-evento-legame")}catch(r){throw console.error("Errore nel caricamento dei tipi evento legame:",r),r}}},W={class:"relative w-full"},j={class:"flex flex-col gap-2"},G=["placeholder"],H={key:0,class:"absolute z-50 w-full top-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Q=["onMousedown"],J={key:0,class:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400 text-center"},P={class:"flex gap-2 items-end"},R=["value"],X=["value","disabled"],Y={key:1,class:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white"},te={__name:"SearchableSelect",props:{modelValue:{type:[String,Number],default:null},options:{type:Array,required:!0},optionLabel:{type:[String,Function],default:"nome_completo"},optionValue:{type:[String,Function],default:"id"},placeholder:{type:String,default:"Cerca..."},emptyOption:{type:String,default:"Seleziona..."},nullValue:{type:[String,Number],default:""},disabled:{type:[Function,Array],default:null},searchFields:{type:Array,default:()=>["nome","cognome","nome_completo"]},selectClass:{type:String,default:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},showAllWhenOpen:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(r,{emit:F}){const l=r,v=F,s=w(""),n=w(!1),o=w(l.modelValue),i=e=>typeof l.optionValue=="function"?l.optionValue(e):e[l.optionValue],p=e=>typeof l.optionLabel=="function"?l.optionLabel(e):e[l.optionLabel]||"",b=e=>l.disabled?Array.isArray(l.disabled)?l.disabled.includes(i(e)):typeof l.disabled=="function"?l.disabled(e):!1:!1,$=e=>i(e)==o.value,h=x(()=>[...l.options].sort((e,a)=>{const t=(e.cognome||"").toLowerCase(),c=(a.cognome||"").toLowerCase();if(t!==c)return t.localeCompare(c,"it");const D=(e.nome||"").toLowerCase(),E=(a.nome||"").toLowerCase();return D.localeCompare(E,"it")})),S=x(()=>{if(!s.value)return h.value;const e=s.value.toLowerCase();return h.value.filter(a=>l.searchFields.some(t=>{const c=a[t];return c?c.toString().toLowerCase().includes(e):!1}))}),N=e=>{if(b(e))return;const a=i(e);o.value=a;const t=p(e);s.value=t,n.value=!1,v("update:modelValue",a),v("change",a,e)},M=e=>{const a=e.target.value===l.nullValue?null:e.target.value;o.value=a,v("update:modelValue",a),v("change",a)},_=()=>{setTimeout(()=>{n.value=!1},200)};C(()=>l.modelValue,e=>{e!==o.value&&(o.value=e||l.nullValue)},{immediate:!0});const g=x(()=>o.value?l.options.find(e=>i(e)==o.value):null),z=()=>{n.value=!0};return C(o,e=>{e&&g.value?n.value||(s.value=p(g.value)):n.value||(s.value="")}),(e,a)=>(d(),u("div",W,[y("div",j,[L(y("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>s.value=t),type:"text",placeholder:r.placeholder||"Cerca per nome o cognome...",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",onFocus:a[1]||(a[1]=t=>n.value=!0),onBlur:_,onKeydown:a[2]||(a[2]=I(t=>n.value=!1,["escape"])),onInput:z},null,40,G),[[q,s.value]]),n.value&&(s.value||r.showAllWhenOpen)?(d(),u("div",H,[(d(!0),u(O,null,A(S.value,t=>(d(),u("div",{key:i(t),onMousedown:K(c=>N(t),["prevent"]),class:B(["px-3 py-2 text-sm cursor-pointer hover:bg-blue-50 dark:hover:bg-gray-700 transition-colors",{"bg-blue-100 dark:bg-gray-700":$(t),"opacity-50 cursor-not-allowed":b(t)}])},[f(e.$slots,"option",{option:t},()=>[V(m(p(t)),1)])],42,Q))),128)),S.value.length===0?(d(),u("div",J," Nessun risultato trovato ")):k("",!0)])):k("",!0),y("div",P,[!n.value||!s.value?L((d(),u("select",{key:0,"onUpdate:modelValue":a[3]||(a[3]=t=>o.value=t),class:B([r.selectClass,"flex-1"]),onChange:M,onFocus:a[4]||(a[4]=t=>n.value=!1)},[y("option",{value:r.nullValue},m(r.emptyOption||"Seleziona..."),9,R),(d(!0),u(O,null,A(h.value,t=>(d(),u("option",{key:i(t),value:i(t),disabled:b(t)},[f(e.$slots,"option",{option:t},()=>[V(m(p(t)),1)])],8,X))),128))],34)),[[U,o.value]]):o.value&&g.value?(d(),u("div",Y,[f(e.$slots,"option",{option:g.value},()=>[V(m(p(g.value)),1)])])):k("",!0),f(e.$slots,"actions")])])]))}};export{te as _,ee as t};
