import{h,r as g,i as k,c as l,a as e,t as a,d as b,j as x,F as f,D as w,E as L,o as n,y as M}from"./app-CQqk7krA.js";const A={class:"bg-gray-200 dark:bg-gray-900"},D={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},E={class:"text-2xl font-bold text-gray-900 dark:text-white mb-6"},S={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-4"},j={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},B={class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5"},C={value:""},P={class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5"},U={value:""},V={value:"created"},F={value:"updated"},T={value:"deleted"},z={class:"flex items-end"},I={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},N={key:0,class:"flex items-center justify-center py-12"},O={class:"text-center"},R={class:"text-gray-600 dark:text-gray-400"},$={key:1,class:"text-center py-12"},q={class:"text-gray-600 dark:text-gray-400"},G={key:2,class:"divide-y divide-gray-200 dark:divide-gray-700"},H={class:"flex items-start justify-between"},J={class:"flex-1"},K={class:"flex items-center gap-2 mb-2"},Q={class:"text-sm text-gray-600 dark:text-gray-400"},W={class:"text-sm text-gray-500 dark:text-gray-500"},X={class:"text-sm text-gray-600 dark:text-gray-400"},ee={__name:"AuditLogs",setup(Y){const i=h(),s=d=>i.t(d),c=g(!1),u=g([]),r=g({model_type:"",action:""}),y=async()=>{var d;c.value=!0;try{const t=new URLSearchParams;r.value.model_type&&t.append("model_type",r.value.model_type),r.value.action&&t.append("action",r.value.action);const o=await L.get(`/audit-logs?${t.toString()}`);u.value=((d=o.data.data)==null?void 0:d.data)||[]}catch(t){console.error("Errore nel caricamento dei log:",t)}finally{c.value=!1}},_=d=>({created:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",updated:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",deleted:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"})[d]||"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",m=d=>({created:s("audit.created"),updated:s("audit.updated"),deleted:s("audit.deleted")})[d]||d,v=d=>{if(!d)return"";try{return new Date(d).toLocaleString("it-IT")}catch{return d}};return k(()=>{y(),Object.keys(i.translations).length===0&&i.loadTranslations()}),(d,t)=>(n(),l("div",A,[e("div",D,[e("h1",E,a(s("audit.title")),1),e("div",S,[e("div",j,[e("div",null,[e("label",B,a(s("audit.model_type")),1),b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.value.model_type=o),class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",C,a(s("audit.all")),1),t[2]||(t[2]=e("option",{value:"App\\Models\\Persona"},"Persona",-1)),t[3]||(t[3]=e("option",{value:"App\\Models\\Evento"},"Evento",-1)),t[4]||(t[4]=e("option",{value:"App\\Models\\Media"},"Media",-1))],512),[[x,r.value.model_type]])]),e("div",null,[e("label",P,a(s("audit.action")),1),b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.value.action=o),class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[e("option",U,a(s("audit.all")),1),e("option",V,a(s("audit.created")),1),e("option",F,a(s("audit.updated")),1),e("option",T,a(s("audit.deleted")),1)],512),[[x,r.value.action]])]),e("div",z,[e("button",{onClick:y,class:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"},a(s("search.search")),1)])])]),e("div",I,[c.value?(n(),l("div",N,[e("div",O,[t[5]||(t[5]=e("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-3"},null,-1)),e("p",R,a(s("common.loading")),1)])])):u.value.length===0?(n(),l("div",$,[e("p",q,a(s("audit.no_logs")),1)])):(n(),l("div",G,[(n(!0),l(f,null,w(u.value,o=>{var p;return n(),l("div",{key:o.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("div",H,[e("div",J,[e("div",K,[e("span",{class:M(["px-2 py-1 text-xs font-medium rounded",_(o.action)])},a(m(o.action)),3),e("span",Q,a(o.model_type),1),e("span",W,"#"+a(o.model_id),1)]),e("p",X,a(((p=o.user)==null?void 0:p.name)||s("audit.system"))+" - "+a(v(o.created_at)),1)])])])}),128))]))])])]))}};export{ee as default};
